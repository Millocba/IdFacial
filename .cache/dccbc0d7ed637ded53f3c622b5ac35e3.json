{"dependencies":[{"name":"tslib","loc":{"line":1,"column":50}},{"name":"../factories/WithAge","loc":{"line":2,"column":30}},{"name":"../factories/WithGender","loc":{"line":3,"column":33}},{"name":"./ComposableTask","loc":{"line":4,"column":31}},{"name":"./ComputeFaceDescriptorsTasks","loc":{"line":5,"column":79}},{"name":"./extractFacesAndComputeResults","loc":{"line":6,"column":84}},{"name":"./nets","loc":{"line":7,"column":21}},{"name":"./PredictFaceExpressionsTask","loc":{"line":8,"column":180}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PredictSingleAgeAndGenderWithFaceAlignmentTask = exports.PredictAllAgeAndGenderWithFaceAlignmentTask = exports.PredictSingleAgeAndGenderTask = exports.PredictAllAgeAndGenderTask = exports.PredictAgeAndGenderTaskBase = undefined;\n\nvar _tslib = require(\"tslib\");\n\nvar _WithAge = require(\"../factories/WithAge\");\n\nvar _WithGender = require(\"../factories/WithGender\");\n\nvar _ComposableTask = require(\"./ComposableTask\");\n\nvar _ComputeFaceDescriptorsTasks = require(\"./ComputeFaceDescriptorsTasks\");\n\nvar _extractFacesAndComputeResults = require(\"./extractFacesAndComputeResults\");\n\nvar _nets = require(\"./nets\");\n\nvar _PredictFaceExpressionsTask = require(\"./PredictFaceExpressionsTask\");\n\nvar PredictAgeAndGenderTaskBase = /** @class */function (_super) {\n  (0, _tslib.__extends)(PredictAgeAndGenderTaskBase, _super);\n  function PredictAgeAndGenderTaskBase(parentTask, input, extractedFaces) {\n    var _this = _super.call(this) || this;\n    _this.parentTask = parentTask;\n    _this.input = input;\n    _this.extractedFaces = extractedFaces;\n    return _this;\n  }\n  return PredictAgeAndGenderTaskBase;\n}(_ComposableTask.ComposableTask);\nexports.PredictAgeAndGenderTaskBase = PredictAgeAndGenderTaskBase;\n\nvar PredictAllAgeAndGenderTask = /** @class */function (_super) {\n  (0, _tslib.__extends)(PredictAllAgeAndGenderTask, _super);\n  function PredictAllAgeAndGenderTask() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  PredictAllAgeAndGenderTask.prototype.run = function () {\n    return (0, _tslib.__awaiter)(this, void 0, void 0, function () {\n      var parentResults, ageAndGenderByFace;\n      var _this = this;\n      return (0, _tslib.__generator)(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.parentTask];\n          case 1:\n            parentResults = _a.sent();\n            return [4 /*yield*/, (0, _extractFacesAndComputeResults.extractAllFacesAndComputeResults)(parentResults, this.input, function (faces) {\n              return (0, _tslib.__awaiter)(_this, void 0, void 0, function () {\n                return (0, _tslib.__generator)(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      return [4 /*yield*/, Promise.all(faces.map(function (face) {\n                        return _nets.nets.ageGenderNet.predictAgeAndGender(face);\n                      }))];\n                    case 1:\n                      return [2 /*return*/, _a.sent()];\n                  }\n                });\n              });\n            }, this.extractedFaces)];\n          case 2:\n            ageAndGenderByFace = _a.sent();\n            return [2 /*return*/, parentResults.map(function (parentResult, i) {\n              var _a = ageAndGenderByFace[i],\n                  age = _a.age,\n                  gender = _a.gender,\n                  genderProbability = _a.genderProbability;\n              return (0, _WithAge.extendWithAge)((0, _WithGender.extendWithGender)(parentResult, gender, genderProbability), age);\n            })];\n        }\n      });\n    });\n  };\n  PredictAllAgeAndGenderTask.prototype.withFaceExpressions = function () {\n    return new _PredictFaceExpressionsTask.PredictAllFaceExpressionsTask(this, this.input);\n  };\n  return PredictAllAgeAndGenderTask;\n}(PredictAgeAndGenderTaskBase);\nexports.PredictAllAgeAndGenderTask = PredictAllAgeAndGenderTask;\n\nvar PredictSingleAgeAndGenderTask = /** @class */function (_super) {\n  (0, _tslib.__extends)(PredictSingleAgeAndGenderTask, _super);\n  function PredictSingleAgeAndGenderTask() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  PredictSingleAgeAndGenderTask.prototype.run = function () {\n    return (0, _tslib.__awaiter)(this, void 0, void 0, function () {\n      var parentResult, _a, age, gender, genderProbability;\n      return (0, _tslib.__generator)(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            return [4 /*yield*/, this.parentTask];\n          case 1:\n            parentResult = _b.sent();\n            if (!parentResult) {\n              return [2 /*return*/];\n            }\n            return [4 /*yield*/, (0, _extractFacesAndComputeResults.extractSingleFaceAndComputeResult)(parentResult, this.input, function (face) {\n              return _nets.nets.ageGenderNet.predictAgeAndGender(face);\n            }, this.extractedFaces)];\n          case 2:\n            _a = _b.sent(), age = _a.age, gender = _a.gender, genderProbability = _a.genderProbability;\n            return [2 /*return*/, (0, _WithAge.extendWithAge)((0, _WithGender.extendWithGender)(parentResult, gender, genderProbability), age)];\n        }\n      });\n    });\n  };\n  PredictSingleAgeAndGenderTask.prototype.withFaceExpressions = function () {\n    return new _PredictFaceExpressionsTask.PredictSingleFaceExpressionsTask(this, this.input);\n  };\n  return PredictSingleAgeAndGenderTask;\n}(PredictAgeAndGenderTaskBase);\nexports.PredictSingleAgeAndGenderTask = PredictSingleAgeAndGenderTask;\n\nvar PredictAllAgeAndGenderWithFaceAlignmentTask = /** @class */function (_super) {\n  (0, _tslib.__extends)(PredictAllAgeAndGenderWithFaceAlignmentTask, _super);\n  function PredictAllAgeAndGenderWithFaceAlignmentTask() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  PredictAllAgeAndGenderWithFaceAlignmentTask.prototype.withFaceExpressions = function () {\n    return new _PredictFaceExpressionsTask.PredictAllFaceExpressionsWithFaceAlignmentTask(this, this.input);\n  };\n  PredictAllAgeAndGenderWithFaceAlignmentTask.prototype.withFaceDescriptors = function () {\n    return new _ComputeFaceDescriptorsTasks.ComputeAllFaceDescriptorsTask(this, this.input);\n  };\n  return PredictAllAgeAndGenderWithFaceAlignmentTask;\n}(PredictAllAgeAndGenderTask);\nexports.PredictAllAgeAndGenderWithFaceAlignmentTask = PredictAllAgeAndGenderWithFaceAlignmentTask;\n\nvar PredictSingleAgeAndGenderWithFaceAlignmentTask = /** @class */function (_super) {\n  (0, _tslib.__extends)(PredictSingleAgeAndGenderWithFaceAlignmentTask, _super);\n  function PredictSingleAgeAndGenderWithFaceAlignmentTask() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  PredictSingleAgeAndGenderWithFaceAlignmentTask.prototype.withFaceExpressions = function () {\n    return new _PredictFaceExpressionsTask.PredictSingleFaceExpressionsWithFaceAlignmentTask(this, this.input);\n  };\n  PredictSingleAgeAndGenderWithFaceAlignmentTask.prototype.withFaceDescriptor = function () {\n    return new _ComputeFaceDescriptorsTasks.ComputeSingleFaceDescriptorTask(this, this.input);\n  };\n  return PredictSingleAgeAndGenderWithFaceAlignmentTask;\n}(PredictSingleAgeAndGenderTask);\nexports.PredictSingleAgeAndGenderWithFaceAlignmentTask = PredictSingleAgeAndGenderWithFaceAlignmentTask;\n//# sourceMappingURL=PredictAgeAndGenderTask.js.map"},"hash":"437d9a4a2fad7e67df9b48ddcc671161"}